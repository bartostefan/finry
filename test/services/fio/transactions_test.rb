# frozen_string_literal: true

require 'test_helper'

module Fio
  class TransactionsTest < ActiveSupport::TestCase
    setup do
      # rubocop:disable LineLength
      stub_request(:get, 'https://www.fio.cz/ib_api/rest/periods/AAA/2017-09-01/2017-09-30/transactions.json')
        .with(headers: { 'Accept' => '*/*', 'Accept-Encoding' => 'gzip;q=1.0,deflate;q=0.6,identity;q=0.3', 'User-Agent' => 'Ruby' })
        .to_return(status: 200, body: '{"accountStatement":{"info":{"accountId":"2000301478","bankId":"2010","currency":"CZK","iban":"CZ2820100000002000301478","bic":"FIOBCZPPXXX","openingBalance":3007.77,"closingBalance":5074.19,"dateStart":"2017-09-01+0200","dateEnd":"2017-09-30+0200","yearList":null,"idList":null,"idFrom":14413550503,"idTo":14428839320,"idLastDownload":null},"transactionList":{"transaction":[{"column22":{"value":14413550503,"name":"ID pohybu","id":22},"column0":{"value":"2017-09-02+0200","name":"Datum","id":0},"column1":{"value":-224.00,"name":"Objem","id":1},"column14":{"value":"CZK","name":"Měna","id":14},"column2":null,"column10":null,"column3":null,"column12":null,"column4":null,"column5":{"value":"5861","name":"VS","id":5},"column6":null,"column7":{"value":"Nákup: MULTIKINO CINESTAR, PRAHA, dne 31.8.2017, částka  224.00 CZK","name":"Uživatelská identifikace","id":7},"column16":{"value":"Nákup: MULTIKINO CINESTAR, PRAHA, dne 31.8.2017, částka  224.00 CZK","name":"Zpráva pro příjemce","id":16},"column8":{"value":"Platba kartou","name":"Typ","id":8},"column9":{"value":"Bartoš, Štefan","name":"Provedl","id":9},"column18":null,"column25":{"value":"Nákup: MULTIKINO CINESTAR, PRAHA, dne 31.8.2017, částka  224.00 CZK","name":"Komentář","id":25},"column26":null,"column17":{"value":16124877825,"name":"ID pokynu","id":17}},{"column22":{"value":14413786238,"name":"ID pohybu","id":22},"column0":{"value":"2017-09-03+0200","name":"Datum","id":0},"column1":{"value":-153.00,"name":"Objem","id":1},"column14":{"value":"CZK","name":"Měna","id":14},"column2":null,"column10":null,"column3":null,"column12":null,"column4":null,"column5":{"value":"5861","name":"VS","id":5},"column6":null,"column7":{"value":"Nákup: FAMATYP MATYASKOVA, CHLEBICOV, dne 1.9.2017, částka  153.00 CZK","name":"Uživatelská identifikace","id":7},"column16":{"value":"Nákup: FAMATYP MATYASKOVA, CHLEBICOV, dne 1.9.2017, částka  153.00 CZK","name":"Zpráva pro příjemce","id":16},"column8":{"value":"Platba kartou","name":"Typ","id":8},"column9":{"value":"Bartoš, Štefan","name":"Provedl","id":9},"column18":null,"column25":{"value":"Nákup: FAMATYP MATYASKOVA, CHLEBICOV, dne 1.9.2017, částka  153.00 CZK","name":"Komentář","id":25},"column26":null,"column17":{"value":16125858206,"name":"ID pokynu","id":17}},{"column22":{"value":14413786239,"name":"ID pohybu","id":22},"column0":{"value":"2017-09-03+0200","name":"Datum","id":0},"column1":{"value":-277.00,"name":"Objem","id":1},"column14":{"value":"CZK","name":"Měna","id":14},"column2":null,"column10":null,"column3":null,"column12":null,"column4":null,"column5":{"value":"5861","name":"VS","id":5},"column6":null,"column7":{"value":"Nákup: KFC Breda Opava, Opava, CZ, dne 1.9.2017, částka  277.00 CZK","name":"Uživatelská identifikace","id":7},"column16":{"value":"Nákup: KFC Breda Opava, Opava, CZ, dne 1.9.2017, částka  277.00 CZK","name":"Zpráva pro příjemce","id":16},"column8":{"value":"Platba kartou","name":"Typ","id":8},"column9":{"value":"Bartoš, Štefan","name":"Provedl","id":9},"column18":null,"column25":{"value":"Nákup: KFC Breda Opava, Opava, CZ, dne 1.9.2017, částka  277.00 CZK","name":"Komentář","id":25},"column26":null,"column17":{"value":16125858208,"name":"ID pokynu","id":17}},{"column22":{"value":14414157296,"name":"ID pohybu","id":22},"column0":{"value":"2017-09-04+0200","name":"Datum","id":0},"column1":{"value":22000.00,"name":"Objem","id":1},"column14":{"value":"CZK","name":"Měna","id":14},"column2":{"value":"2200327090","name":"Protiúčet","id":2},"column10":{"value":"Bartoš, Štefan","name":"Název protiúčtu","id":10},"column3":{"value":"2010","name":"Kód banky","id":3},"column12":{"value":"Fio banka, a.s.","name":"Název banky","id":12},"column4":null,"column5":null,"column6":null,"column7":null,"column16":{"value":"Vyber podnikatele","name":"Zpráva pro příjemce","id":16},"column8":{"value":"Příjem převodem uvnitř banky","name":"Typ","id":8},"column9":null,"column18":null,"column25":{"value":"Vyber podnikatele","name":"Komentář","id":25},"column26":null,"column17":{"value":16127434204,"name":"ID pokynu","id":17}},{"column22":{"value":14414828462,"name":"ID pohybu","id":22},"column0":{"value":"2017-09-05+0200","name":"Datum","id":0},"column1":{"value":-1215.53,"name":"Objem","id":1},"column14":{"value":"CZK","name":"Měna","id":14},"column2":null,"column10":null,"column3":null,"column12":null,"column4":null,"column5":{"value":"5861","name":"VS","id":5},"column6":null,"column7":{"value":"Nákup: LATON ALFRED - MASO UZ, CHLEBICOV, CZ, dne 1.9.2017, částka  1215.53 CZK","name":"Uživatelská identifikace","id":7},"column16":{"value":"Nákup: LATON ALFRED - MASO UZ, CHLEBICOV, CZ, dne 1.9.2017, částka  1215.53 CZK","name":"Zpráva pro příjemce","id":16},"column8":{"value":"Platba kartou","name":"Typ","id":8},"column9":{"value":"Bartoš, Štefan","name":"Provedl","id":9},"column18":null,"column25":{"value":"Nákup: LATON ALFRED - MASO UZ, CHLEBICOV, CZ, dne 1.9.2017, částka  1215.53 CZK","name":"Komentář","id":25},"column26":null,"column17":{"value":16130565037,"name":"ID pokynu","id":17}},{"column22":{"value":14414828463,"name":"ID pohybu","id":22},"column0":{"value":"2017-09-05+0200","name":"Datum","id":0},"column1":{"value":-159.00,"name":"Objem","id":1},"column14":{"value":"CZK","name":"Měna","id":14},"column2":null,"column10":null,"column3":null,"column12":null,"column4":null,"column5":{"value":"5861","name":"VS","id":5},"column6":null,"column7":{"value":"Nákup: TPY*SLEVOLEKARNA.CZ, JIHLAVA, CZ, dne 1.9.2017, částka  159.00 CZK","name":"Uživatelská identifikace","id":7},"column16":{"value":"Nákup: TPY*SLEVOLEKARNA.CZ, JIHLAVA, CZ, dne 1.9.2017, částka  159.00 CZK","name":"Zpráva pro příjemce","id":16},"column8":{"value":"Platba kartou","name":"Typ","id":8},"column9":{"value":"Bartoš, Štefan","name":"Provedl","id":9},"column18":null,"column25":{"value":"Nákup: TPY*SLEVOLEKARNA.CZ, JIHLAVA, CZ, dne 1.9.2017, částka  159.00 CZK","name":"Komentář","id":25},"column26":null,"column17":{"value":16130565040,"name":"ID pokynu","id":17}},{"column22":{"value":14414828464,"name":"ID pohybu","id":22},"column0":{"value":"2017-09-05+0200","name":"Datum","id":0},"column1":{"value":-431.00,"name":"Objem","id":1},"column14":{"value":"CZK","name":"Měna","id":14},"column2":null,"column10":null,"column3":null,"column12":null,"column4":null,"column5":{"value":"5861","name":"VS","id":5},"column6":null,"column7":{"value":"Nákup: PIZZA KOBERICE, OPAVA-KATERIN, CZ, dne 2.9.2017, částka  431.00 CZK","name":"Uživatelská identifikace","id":7},"column16":{"value":"Nákup: PIZZA KOBERICE, OPAVA-KATERIN, CZ, dne 2.9.2017, částka  431.00 CZK","name":"Zpráva pro příjemce","id":16},"column8":{"value":"Platba kartou","name":"Typ","id":8},"column9":{"value":"Bartoš, Štefan","name":"Provedl","id":9},"column18":null,"column25":{"value":"Nákup: PIZZA KOBERICE, OPAVA-KATERIN, CZ, dne 2.9.2017, částka  431.00 CZK","name":"Komentář","id":25},"column26":null,"column17":{"value":16130565042,"name":"ID pokynu","id":17}},{"column22":{"value":14414828465,"name":"ID pohybu","id":22},"column0":{"value":"2017-09-05+0200","name":"Datum","id":0},"column1":{"value":-262.20,"name":"Objem","id":1},"column14":{"value":"CZK","name":"Měna","id":14},"column2":null,"column10":null,"column3":null,"column12":null,"column4":null,"column5":{"value":"5861","name":"VS","id":5},"column6":null,"column7":{"value":"Nákup: Kaufland Hlucinska, Opava, CZ, dne 3.9.2017, částka  262.20 CZK","name":"Uživatelská identifikace","id":7},"column16":{"value":"Nákup: Kaufland Hlucinska, Opava, CZ, dne 3.9.2017, částka  262.20 CZK","name":"Zpráva pro příjemce","id":16},"column8":{"value":"Platba kartou","name":"Typ","id":8},"column9":{"value":"Bartoš, Štefan","name":"Provedl","id":9},"column18":null,"column25":{"value":"Nákup: Kaufland Hlucinska, Opava, CZ, dne 3.9.2017, částka  262.20 CZK","name":"Komentář","id":25},"column26":null,"column17":{"value":16130565045,"name":"ID pokynu","id":17}},{"column22":{"value":14416085727,"name":"ID pohybu","id":22},"column0":{"value":"2017-09-07+0200","name":"Datum","id":0},"column1":{"value":-1222.00,"name":"Objem","id":1},"column14":{"value":"CZK","name":"Měna","id":14},"column2":null,"column10":null,"column3":null,"column12":null,"column4":null,"column5":{"value":"5861","name":"VS","id":5},"column6":null,"column7":{"value":"Nákup: EUROBIT-CERPACI STANIC, HOSTICE, dne 4.9.2017, částka  1222.00 CZK","name":"Uživatelská identifikace","id":7},"column16":{"value":"Nákup: EUROBIT-CERPACI STANIC, HOSTICE, dne 4.9.2017, částka  1222.00 CZK","name":"Zpráva pro příjemce","id":16},"column8":{"value":"Platba kartou","name":"Typ","id":8},"column9":{"value":"Bartoš, Štefan","name":"Provedl","id":9},"column18":null,"column25":{"value":"Nákup: EUROBIT-CERPACI STANIC, HOSTICE, dne 4.9.2017, částka  1222.00 CZK","name":"Komentář","id":25},"column26":null,"column17":{"value":16136075009,"name":"ID pokynu","id":17}},{"column22":{"value":14416085728,"name":"ID pohybu","id":22},"column0":{"value":"2017-09-07+0200","name":"Datum","id":0},"column1":{"value":-73.10,"name":"Objem","id":1},"column14":{"value":"CZK","name":"Měna","id":14},"column2":null,"column10":null,"column3":null,"column12":null,"column4":null,"column5":{"value":"5861","name":"VS","id":5},"column6":null,"column7":{"value":"Nákup: FAMATYP MATYASKOVA, CHLEBICOV, dne 5.9.2017, částka  73.10 CZK","name":"Uživatelská identifikace","id":7},"column16":{"value":"Nákup: FAMATYP MATYASKOVA, CHLEBICOV, dne 5.9.2017, částka  73.10 CZK","name":"Zpráva pro příjemce","id":16},"column8":{"value":"Platba kartou","name":"Typ","id":8},"column9":{"value":"Bartoš, Štefan","name":"Provedl","id":9},"column18":null,"column25":{"value":"Nákup: FAMATYP MATYASKOVA, CHLEBICOV, dne 5.9.2017, částka  73.10 CZK","name":"Komentář","id":25},"column26":null,"column17":{"value":16136075011,"name":"ID pokynu","id":17}},{"column22":{"value":14416917081,"name":"ID pohybu","id":22},"column0":{"value":"2017-09-08+0200","name":"Datum","id":0},"column1":{"value":-164.00,"name":"Objem","id":1},"column14":{"value":"CZK","name":"Měna","id":14},"column2":null,"column10":null,"column3":null,"column12":null,"column4":null,"column5":{"value":"5861","name":"VS","id":5},"column6":null,"column7":{"value":"Nákup: MCDONALDS, OPAVA, dne 6.9.2017, částka  164.00 CZK","name":"Uživatelská identifikace","id":7},"column16":{"value":"Nákup: MCDONALDS, OPAVA, dne 6.9.2017, částka  164.00 CZK","name":"Zpráva pro příjemce","id":16},"column8":{"value":"Platba kartou","name":"Typ","id":8},"column9":{"value":"Bartoš, Štefan","name":"Provedl","id":9},"column18":null,"column25":{"value":"Nákup: MCDONALDS, OPAVA, dne 6.9.2017, částka  164.00 CZK","name":"Komentář","id":25},"column26":null,"column17":{"value":16139730447,"name":"ID pokynu","id":17}},{"column22":{"value":14417225541,"name":"ID pohybu","id":22},"column0":{"value":"2017-09-09+0200","name":"Datum","id":0},"column1":{"value":-3390.56,"name":"Objem","id":1},"column14":{"value":"CZK","name":"Měna","id":14},"column2":null,"column10":null,"column3":null,"column12":null,"column4":null,"column5":{"value":"5861","name":"VS","id":5},"column6":null,"column7":{"value":"Nákup: LIDL169, OPAVA, dne 7.9.2017, částka  3390.56 CZK","name":"Uživatelská identifikace","id":7},"column16":{"value":"Nákup: LIDL169, OPAVA, dne 7.9.2017, částka  3390.56 CZK","name":"Zpráva pro příjemce","id":16},"column8":{"value":"Platba kartou","name":"Typ","id":8},"column9":{"value":"Bartoš, Štefan","name":"Provedl","id":9},"column18":null,"column25":{"value":"Nákup: LIDL169, OPAVA, dne 7.9.2017, částka  3390.56 CZK","name":"Komentář","id":25},"column26":null,"column17":{"value":16140812705,"name":"ID pokynu","id":17}},{"column22":{"value":14418728318,"name":"ID pohybu","id":22},"column0":{"value":"2017-09-12+0200","name":"Datum","id":0},"column1":{"value":-293.00,"name":"Objem","id":1},"column14":{"value":"CZK","name":"Měna","id":14},"column2":null,"column10":null,"column3":null,"column12":null,"column4":null,"column5":{"value":"5861","name":"VS","id":5},"column6":null,"column7":{"value":"Nákup: MCDONALDS, OPAVA, dne 10.9.2017, částka  293.00 CZK","name":"Uživatelská identifikace","id":7},"column16":{"value":"Nákup: MCDONALDS, OPAVA, dne 10.9.2017, částka  293.00 CZK","name":"Zpráva pro příjemce","id":16},"column8":{"value":"Platba kartou","name":"Typ","id":8},"column9":{"value":"Bartoš, Štefan","name":"Provedl","id":9},"column18":null,"column25":{"value":"Nákup: MCDONALDS, OPAVA, dne 10.9.2017, částka  293.00 CZK","name":"Komentář","id":25},"column26":null,"column17":{"value":16147417083,"name":"ID pokynu","id":17}},{"column22":{"value":14421184444,"name":"ID pohybu","id":22},"column0":{"value":"2017-09-15+0200","name":"Datum","id":0},"column1":{"value":-1829.00,"name":"Objem","id":1},"column14":{"value":"CZK","name":"Měna","id":14},"column2":null,"column10":null,"column3":null,"column12":null,"column4":null,"column5":{"value":"5861","name":"VS","id":5},"column6":null,"column7":{"value":"Nákup: EUROBIT-CERPACI STANIC, HOSTICE, dne 12.9.2017, částka  1829.00 CZK","name":"Uživatelská identifikace","id":7},"column16":{"value":"Nákup: EUROBIT-CERPACI STANIC, HOSTICE, dne 12.9.2017, částka  1829.00 CZK","name":"Zpráva pro příjemce","id":16},"column8":{"value":"Platba kartou","name":"Typ","id":8},"column9":{"value":"Bartoš, Štefan","name":"Provedl","id":9},"column18":null,"column25":{"value":"Nákup: EUROBIT-CERPACI STANIC, HOSTICE, dne 12.9.2017, částka  1829.00 CZK","name":"Komentář","id":25},"column26":null,"column17":{"value":16158115665,"name":"ID pokynu","id":17}},{"column22":{"value":14422382968,"name":"ID pohybu","id":22},"column0":{"value":"2017-09-18+0200","name":"Datum","id":0},"column1":{"value":-4000.00,"name":"Objem","id":1},"column14":{"value":"CZK","name":"Měna","id":14},"column2":{"value":"8582563001","name":"Protiúčet","id":2},"column10":null,"column3":{"value":"5500","name":"Kód banky","id":3},"column12":{"value":"Raiffeisenbank a.s.","name":"Název banky","id":12},"column4":null,"column5":null,"column6":null,"column7":null,"column16":null,"column8":{"value":"Bezhotovostní platba","name":"Typ","id":8},"column9":{"value":"Bartoš, Štefan","name":"Provedl","id":9},"column18":null,"column25":null,"column26":null,"column17":{"value":16163194967,"name":"ID pokynu","id":17}},{"column22":{"value":14425896039,"name":"ID pohybu","id":22},"column0":{"value":"2017-09-23+0200","name":"Datum","id":0},"column1":{"value":-1375.09,"name":"Objem","id":1},"column14":{"value":"CZK","name":"Měna","id":14},"column2":null,"column10":null,"column3":null,"column12":null,"column4":null,"column5":{"value":"5861","name":"VS","id":5},"column6":null,"column7":{"value":"Nákup: ZLAVOMAT.SK,  MLYNSKE NIVY 73, BRATISLAVA, 82105, CZE, dne 22.9.2017, částka  51.60 EUR","name":"Uživatelská identifikace","id":7},"column16":{"value":"Nákup: ZLAVOMAT.SK,  MLYNSKE NIVY 73, BRATISLAVA, 82105, CZE, dne 22.9.2017, částka  51.60 EUR","name":"Zpráva pro příjemce","id":16},"column8":{"value":"Platba kartou","name":"Typ","id":8},"column9":{"value":"Bartoš, Štefan","name":"Provedl","id":9},"column18":null,"column25":{"value":"Nákup: ZLAVOMAT.SK,  MLYNSKE NIVY 73, BRATISLAVA, 82105, CZE, dne 22.9.2017, částka  51.60 EUR","name":"Komentář","id":25},"column26":null,"column17":{"value":16178558203,"name":"ID pokynu","id":17}},{"column22":{"value":14426929011,"name":"ID pohybu","id":22},"column0":{"value":"2017-09-25+0200","name":"Datum","id":0},"column1":{"value":-1917.50,"name":"Objem","id":1},"column14":{"value":"CZK","name":"Měna","id":14},"column2":null,"column10":null,"column3":null,"column12":null,"column4":null,"column5":{"value":"5861","name":"VS","id":5},"column6":null,"column7":{"value":"Nákup: EUROBIT-CERPACI STANIC,  OPAVSKA 425, HOSTICE, 74731, CZE, dne 23.9.2017, částka  1917.50 Kč","name":"Uživatelská identifikace","id":7},"column16":{"value":"Nákup: EUROBIT-CERPACI STANIC,  OPAVSKA 425, HOSTICE, 74731, CZE, dne 23.9.2017, částka  1917.50 Kč","name":"Zpráva pro příjemce","id":16},"column8":{"value":"Platba kartou","name":"Typ","id":8},"column9":{"value":"Bartoš, Štefan","name":"Provedl","id":9},"column18":null,"column25":{"value":"Nákup: EUROBIT-CERPACI STANIC,  OPAVSKA 425, HOSTICE, 74731, CZE, dne 23.9.2017, částka  1917.50 Kč","name":"Komentář","id":25},"column26":null,"column17":{"value":16182870894,"name":"ID pokynu","id":17}},{"column22":{"value":14427077913,"name":"ID pohybu","id":22},"column0":{"value":"2017-09-26+0200","name":"Datum","id":0},"column1":{"value":-1605.00,"name":"Objem","id":1},"column14":{"value":"CZK","name":"Měna","id":14},"column2":{"value":"2600170205","name":"Protiúčet","id":2},"column10":null,"column3":{"value":"2010","name":"Kód banky","id":3},"column12":{"value":"Fio banka, a.s.","name":"Název banky","id":12},"column4":{"value":"0558","name":"KS","id":4},"column5":null,"column6":null,"column7":null,"column16":{"value":"Kancl Pišta","name":"Zpráva pro příjemce","id":16},"column8":{"value":"Platba převodem uvnitř banky","name":"Typ","id":8},"column9":null,"column18":null,"column25":{"value":"Kancl Pišta","name":"Komentář","id":25},"column26":null,"column17":{"value":16183443617,"name":"ID pokynu","id":17}},{"column22":{"value":14427308466,"name":"ID pohybu","id":22},"column0":{"value":"2017-09-26+0200","name":"Datum","id":0},"column1":{"value":-619.60,"name":"Objem","id":1},"column14":{"value":"CZK","name":"Měna","id":14},"column2":null,"column10":null,"column3":null,"column12":null,"column4":null,"column5":{"value":"5861","name":"VS","id":5},"column6":null,"column7":{"value":"Nákup: LIDL427,  SJIZDNA 1157/1, OSTRAVA, 72100, CZE, dne 25.9.2017, částka  619.60 Kč","name":"Uživatelská identifikace","id":7},"column16":{"value":"Nákup: LIDL427,  SJIZDNA 1157/1, OSTRAVA, 72100, CZE, dne 25.9.2017, částka  619.60 Kč","name":"Zpráva pro příjemce","id":16},"column8":{"value":"Platba kartou","name":"Typ","id":8},"column9":{"value":"Bartoš, Štefan","name":"Provedl","id":9},"column18":null,"column25":{"value":"Nákup: LIDL427,  SJIZDNA 1157/1, OSTRAVA, 72100, CZE, dne 25.9.2017, částka  619.60 Kč","name":"Komentář","id":25},"column26":null,"column17":{"value":16184443135,"name":"ID pokynu","id":17}},{"column22":{"value":14428046347,"name":"ID pohybu","id":22},"column0":{"value":"2017-09-27+0200","name":"Datum","id":0},"column1":{"value":-119.00,"name":"Objem","id":1},"column14":{"value":"CZK","name":"Měna","id":14},"column2":null,"column10":null,"column3":null,"column12":null,"column4":null,"column5":{"value":"5861","name":"VS","id":5},"column6":null,"column7":{"value":"Nákup: FORTYS PIZZA,  OPAVSKA 97, OSTRAVA, 708 00, CZE, dne 25.9.2017, částka  119.00 Kč","name":"Uživatelská identifikace","id":7},"column16":{"value":"Nákup: FORTYS PIZZA,  OPAVSKA 97, OSTRAVA, 708 00, CZE, dne 25.9.2017, částka  119.00 Kč","name":"Zpráva pro příjemce","id":16},"column8":{"value":"Platba kartou","name":"Typ","id":8},"column9":{"value":"Bartoš, Štefan","name":"Provedl","id":9},"column18":null,"column25":{"value":"Nákup: FORTYS PIZZA,  OPAVSKA 97, OSTRAVA, 708 00, CZE, dne 25.9.2017, částka  119.00 Kč","name":"Komentář","id":25},"column26":null,"column17":{"value":16187558408,"name":"ID pokynu","id":17}},{"column22":{"value":14428195876,"name":"ID pohybu","id":22},"column0":{"value":"2017-09-27+0200","name":"Datum","id":0},"column1":{"value":-14.00,"name":"Objem","id":1},"column14":{"value":"CZK","name":"Měna","id":14},"column2":null,"column10":null,"column3":null,"column12":null,"column4":null,"column5":{"value":"5861","name":"VS","id":5},"column6":null,"column7":{"value":"Nákup: DP - OSTR*15L008,  PODEBRADOVA 494/2, OSTRAVA, 70171, CZE, dne 21.9.2017, částka  14.00 Kč","name":"Uživatelská identifikace","id":7},"column16":{"value":"Nákup: DP - OSTR*15L008,  PODEBRADOVA 494/2, OSTRAVA, 70171, CZE, dne 21.9.2017, částka  14.00 Kč","name":"Zpráva pro příjemce","id":16},"column8":{"value":"Platba kartou","name":"Typ","id":8},"column9":{"value":"Bartoš, Štefan","name":"Provedl","id":9},"column18":null,"column25":{"value":"Nákup: DP - OSTR*15L008,  PODEBRADOVA 494/2, OSTRAVA, 70171, CZE, dne 21.9.2017, částka  14.00 Kč","name":"Komentář","id":25},"column26":null,"column17":{"value":16188233065,"name":"ID pokynu","id":17}},{"column22":{"value":14428839320,"name":"ID pohybu","id":22},"column0":{"value":"2017-09-29+0200","name":"Datum","id":0},"column1":{"value":-590.00,"name":"Objem","id":1},"column14":{"value":"CZK","name":"Měna","id":14},"column2":null,"column10":null,"column3":null,"column12":null,"column4":null,"column5":{"value":"5861","name":"VS","id":5},"column6":null,"column7":{"value":"Nákup: EUROBIT-CERPACI STANIC,  OPAVSKA 425, HOSTICE, 74731, CZE, dne 27.9.2017, částka  590.00 Kč","name":"Uživatelská identifikace","id":7},"column16":{"value":"Nákup: EUROBIT-CERPACI STANIC,  OPAVSKA 425, HOSTICE, 74731, CZE, dne 27.9.2017, částka  590.00 Kč","name":"Zpráva pro příjemce","id":16},"column8":{"value":"Platba kartou","name":"Typ","id":8},"column9":{"value":"Bartoš, Štefan","name":"Provedl","id":9},"column18":null,"column25":{"value":"Nákup: EUROBIT-CERPACI STANIC,  OPAVSKA 425, HOSTICE, 74731, CZE, dne 27.9.2017, částka  590.00 Kč","name":"Komentář","id":25},"column26":null,"column17":{"value":16190797990,"name":"ID pokynu","id":17}}]}}}', headers: {})
      # rubocop:enable LineLength
    end

    test 'get the results from FIO API' do
      assert_difference 'FioItem.count', 21 do
        @result = Fio::Transactions.call(date_from: '2017-09-01', date_to: '2017-09-30', token_id: tokens(:one).id)
      end
      transaction = @result.last
      fio_item = FioItem.last

      assert_equal(transaction.amount, fio_item.amount)
      assert_equal(transaction.comment.split(',')[0], fio_item.comment)
      assert_equal(transaction.transaction_id.to_s, fio_item.transaction_id)
    end
  end
end
